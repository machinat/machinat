---
title: UI Component
---

> While your app getting more complex, we might want to reuse UI to keep the codes [DRY](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself).
> In this lesson, we'll go deeper to make reusable chat UI component.
>
> _Time to accomplish: 15 minutes_

## Building Component

Let's continue creating the todos list UI.
But this time, we'll build it in a customized **JSX Component**.

First add this type that represent the todo data:

```ts title="src/types.ts"
//...
export type Todo = {
  id: number;
  name: string;
};
```

Then create a `src/components/TodoList.tsx` file with the following content:


import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs
  groupId="chat-platforms"
  defaultValue="messenger"
  values={[
    {label: 'Messenger', value: 'messenger'},
    {label: 'Telegram', value: 'telegram'},
    {label: 'LINE', value: 'line'},
  ]}>
  <TabItem value="messenger">


```tsx title="src/components/TodoList.tsx"
import Machinat from '@machinat/core';
import * as Messenger from '@machinat/messenger/components';
import { Todo } from '../types';

type TodoListProps = {
  todos: Todo[];
};

const TodoList = ({ todos }: TodoListProps, { platform }) => {
  if (todos.length === 0) {
    return <p>You have no todo now.</p>;
  }

  const summary = <p>You have <b>{todos.length}</b> todos:</p>;
  const finishLabel = 'Done âœ“';

  if (platform === 'messenger') {
    return (
      <>
        {summary}
        <Messenger.GenericTemplate>
          {todos.slice(0, 10).map((todo) => (
            <Messenger.GenericItem
              title={todo.name}
              buttons={
                <Messenger.PostbackButton
                  title={finishLabel}
                  payload={JSON.stringify({ action: 'finish', id: todo.id })}
                />
              }
            />
          ))}
        </Messenger.GenericTemplate>
      </>
    );
  }

  return (
    <>
      {summary}
      {todos.map((todo) => <p>{todo.name}</p>)}
    </>
  );
};

export default TodoList;
```


   </TabItem>
   <TabItem value="telegram">


```tsx title="src/components/TodoList.tsx"
import Machinat from '@machinat/core';
import * as Telegram from '@machinat/telegram/components';
import { Todo } from '../types';

type TodoListProps = {
  todos: Todo[];
};

const TodoList = ({ todos }: TodoListProps, { platform }) => {
  if (todos.length === 0) {
    return <p>You have no todo now.</p>;
  }

  const summary = <p>You have <b>{todos.length}</b> todos:</p>;
  const finishLabel = 'Done âœ“';

  if (platform === 'telegram') {
    return (
      <>
        {summary}
        {todos.slice(0, 10).map((todo) => (
          <Telegram.Text
            replyMarkup={
              <Telegram.InlineKeyboard>
                <Telegram.CallbackButton
                  text={finishLabel}
                  data={JSON.stringify({ action: 'finish', id: todo.id })}
                />
              </Telegram.InlineKeyboard>
            }
          >
            {todo.name}
          </Telegram.Text>
        ))}
      </>
    );
  }

  return (
    <>
      {summary}
      {todos.map((todo) => <p>{todo.name}</p>)}
    </>
  );
};

export default TodoList;
```


  </TabItem>
  <TabItem value="line">


```tsx title="src/components/TodoList.tsx"
import Machinat from '@machinat/core';
import * as Line from '@machinat/line/components';
import { Todo } from '../types';

type TodoListProps = {
  todos: Todo[];
};

const TodoList = ({ todos }: TodoListProps, { platform }) => {
  if (todos.length === 0) {
    return <p>You have no todo now.</p>;
  }

  const summary = <p>You have <b>{todos.length}</b> todos:</p>;
  const finishLabel = 'Done âœ“';

  if (platform === 'line') {
    return (
      <>
        {summary}
        <Line.CarouselTemplate
          altText={todos.map((todo) => todo.name).join('\n')}
        >
          {todos.slice(0, 10).map((todo) => (
            <Line.CarouselItem
              actions={
                <Line.PostbackAction
                  label={finishLabel}
                  data={JSON.stringify({ action: 'finish', id: todo.id })}
                />
              }
            >
              {todo.name}
            </Line.CarouselItem>
          ))}
        </Line.CarouselTemplate>
      </>
    );
  }

  return (
    <>
      {summary}
      {todos.map((todo) => <p>{todo.name}</p>)}
    </>
  );
};

export default TodoList;
```


  </TabItem>
</Tabs>


The component can then be used in the `handleChat` like:

```tsx {1,5-11} title="src/handlers/handleChat.tsx"
import TodoList from '../components/TodoList';
// ...
  if (action.type === 'list') {
    return reply(
      <TodoList
        todos={[
          { id: 1, name: 'Buy a mask' },
          { id: 2, name: 'Wear it on' },
          { id: 3, name: 'Be safe' },
        ]}
      />
    );
  }
// ...
```

Now tap the `Show Todos ðŸ“‘` button again, the bot should reply like:

<img width={400} src={require("./assets/list-todo-2.gif").default} />

> The `Done âœ“` button post back a `'finish'` action with the todo id, we will
handle that at next lesson.

### The Component Function

A **component** is a function with **capitalized** name.
It can be used as the JSX element tag just like a native component:

```tsx
<TodoList todos={[{ id: 1, name: 'foo' }, /* ... */]} />
```

The first argument of the function is **props** of the JSX element.
`TodoList` function will receive a `{ todos: [/* ... */] }` object while rendering
messages.

Then we can use the `todos` prop to return the UI:

```tsx
  return (
    <>
      {summary}
      {todos.map((todo) => <p>{todo.name}</p>)}
    </>
  );
```

### Insert an Array

To display the todos list, we can insert an array of elements in JSX.
The `{todos.map(todo => <p>{todo.name}</p>)}` code above actually
shows the same result as:

```tsx
<>
  <p>{todo[1].name}</p>
  <p>{todo[2].name}</p>
  <p>{todo[3].name}</p>
</>
```

### Cross-Platform Component

We might want to customize messages for each platform while making a cross-platform app.
To do this, we can return different UI accorfing to the `platform` at the second argument.
Like:

```tsx
const TodoList = ({ todos }: TodoListProps, { platform }) => {
  // ...
  if (platform === 'messenger') {
    return (
      // messenger UI element
    );
  }
  // ...
```

At the end of the function, we can return a general UI as the default message:

```tsx
  // ...
  return (
    <>
      {summary}
      {todos.map((todo) => <p>{todo.name}</p>)}
    </>
  );
};
```

With this strategy, we can cutomize cross-platfrom UI that works on all the platforms.

## The Children Prop

Another common strategy is wrapping around the children of the element.
Let's use it to make a menu component.

Edit `src/components/WithMenu.tsx` component like this:


<Tabs
  groupId="chat-platforms"
  defaultValue="messenger"
  values={[
    {label: 'Messenger', value: 'messenger'},
    {label: 'Telegram', value: 'telegram'},
    {label: 'LINE', value: 'line'},
  ]}>
  <TabItem value="messenger">


```tsx {4,9-14,18-36,41-44} tsx title="src/components/WithMenu.tsx"
//...
type WithMenuProps = {
  children: MachinatNode;
  todoCount: number;
};

const WithMenu =
  (domain: string) =>
  ({ children, todoCount }: WithMenuProps, { platform }) => {
    const info = <>You have <b>{todoCount}</b> todos now.</>;
    const listLabel = 'Show Todos ðŸ“‘';
    const listData = JSON.stringify({ action: 'list' });
    const addLabel = 'New Todo âž•';
    const addData = JSON.stringify({ action: 'add' });

    if (platform === 'messenger') {
      return (
        <>
          {children}
          <Messenger.ButtonTemplate
            buttons={
              <>
                <Messenger.PostbackButton
                  title={listLabel}
                  payload={listData}
                />
                <Messenger.PostbackButton
                  title={addLabel}
                  payload={addData}
                />
              </>
            }
          >
            {info}
          </Messenger.ButtonTemplate>
        </>
      );
    }

    return (
      <>
        {children}
        <p>{info}</p>
      </>
    );
  };
//...
```


  </TabItem>
  <TabItem value="telegram">


```tsx {4,9-14,18-36,41-44} title="src/components/WithMenu.tsx"
//...
type WithMenuProps = {
  children: MachinatNode;
  todoCount: number;
};

const WithMenu =
  (domain: string) =>
  ({ children, todoCount }: WithMenuProps, { platform }) => {
    const info = <>You have <b>{todoCount}</b> todos now.</>;
    const listLabel = 'Show Todos ðŸ“‘';
    const listData = JSON.stringify({ action: 'list' });
    const addLabel = 'New Todo âž•';
    const addData = JSON.stringify({ action: 'add' });

    if (platform === 'telegram') {
      return (
        <>
          {children}
          <Telegram.Text
            replyMarkup={
              <Telegram.InlineKeyboard>
                <Telegram.CallbackButton
                  text={listLabel}
                  data={listData}
                />
                <Telegram.CallbackButton
                  text={addLabel}
                  data={addData}
                />
              </Telegram.InlineKeyboard>
            }
          >
            {info}
          </Telegram.Text>
        </>
      );
    }

    return (
      <>
        {children}
        <p>{info}</p>
      </>
    );
  };
//...
```


  </TabItem>
  <TabItem value="line">


```tsx {4,9-14,18-39,44-47} title="src/components/WithMenu.tsx"
//...
type WithMenuProps = {
  children: MachinatNode;
  todoCount: number;
};

const WithMenu =
  (domain: string, lineLiffId: string) =>
  ({ children, todoCount }: WithMenuProps, { platform }) => {
    const info = <>You have <b>{todoCount}</b> todos now.</>;
    const listLabel = 'Show Todos ðŸ“‘';
    const listData = JSON.stringify({ action: 'list' });
    const addLabel = 'New Todo âž•';
    const addData = JSON.stringify({ action: 'add' });

  if (platform === 'line') {
    return (
      <>
        {children}
        <Line.ButtonTemplate
          altText={`You have ${todoCount} todos now.`}
          actions={
            <>
              <Line.PostbackAction
                label={listLabel}
                displayText={listLabel}
                data={listData}
              />
              <Line.PostbackAction
                label={addLabel}
                displayText={addLabel}
                data={addData}
              />
            </>
          }
        >
          {info}
        </Line.ButtonTemplate>
      </>
    );
  }

  return (
    <>
      {children}
      <p>{info}<p/>
    </>
  );
};
//...
```


  </TabItem>
</Tabs>


Then we can use it in `handleChat` like this:

```tsx {9-11,17-19} title="src/handlers/handleChat.tsx"
import WithMenu from '../components/WithMenu';
//...
    if (event.type === 'text') {
      const matchingAddTodo = event.text.match(/add(\s+todo)?(.*)/i);

      if (matchingAddTodo) {
        const todoName = matchingAddTodo[2].trim();
        return reply(
          <WithMenu todoCount={3}>
            <p>Todo "<b>{todoName}</b>" is added!</p>
          </WithMenu>
        );
      }
    }

    return reply(
      <WithMenu todoCount={3}>
        <p>Hello! I'm a Todo Bot ðŸ¤–</p>
      </WithMenu>
    );
  };
//...
```

Now the menu should be attached like this:

<img width={400} src={require("./assets/hello-with-menu.png").default} />


In the codes above, we pass messages to the `WithMenu` component like:

```tsx
<WithMenu todoCount={3}>
  <p>Hello! I'm a Todo Bot ðŸ¤–</p>
</WithMenu>
```

The `<p>Hello! I'm a Todo Bot ðŸ¤–</p>` is then available as `children`
prop in component function. We can simply return it with the menu attached
below. Like:

```tsx
  return (
    <>
      {children}
      <Messenger.ButtonTemplate
        buttons={<>...</>}
      >
        {info}
      </Messenger.ButtonTemplate>
    </>
  );
```

You can use this strategy to elegantly decorate the messages,
like attaching a greeting, a menu or a feedback survey.

---

We are able to build complex, cross-platform and reusable chat UI with **components**.
Next, we'll display these UI with real data.
